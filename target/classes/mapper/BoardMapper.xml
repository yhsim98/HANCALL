<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="repository.BoardMapper">

    <insert parameterType="domain.Board" id="insertBoard">
        INSERT INTO board(writer_id, starting_point, destination, title, content, created_date, update_date)
            VALUES(#{writerId}, #{startingPoint}, #{destination}, #{title}, #{content}, DEFAULT, DEFAULT)
    </insert>

    <select id="getBoardList" resultType="domain.Board">
        SELECT starting_point, destination, title, update_date, user.nickname
        FROM board
        LEFT JOIN user ON board.writer_id=user.id
    </select>

    <select id="getBoardById" resultType="domain.Board" parameterType="Long">
        SELECT starting_point, destination, created_date, update_date, title, content, user.nickname
        FROM board
        LEFT JOIN user ON board.writer_id=user.id
        WHERE id=#{boardId}
    </select>

    <select id="getBoardListByDestination" parameterType="domain.Board" resultType="domain.Board">
        SELECT starting_point, destination, created_date, update_date, title, content, user.nickname
        FROM board
        LEFT JOIN user ON board.writer_id=user.id
        WHERE destination=#{destination}
    </select>

    <select id="getBoardListByStartingPoint" parameterType="domain.Board" resultType="domain.Board">
        SELECT starting_point, destination, created_date, update_date, title, content, user.nickname
        FROM board
        LEFT JOIN user ON board.writer_id=user.id
        WHERE starting_point=#{startingPoint}
    </select>

    <select id="getBoardListBySPAndDes" parameterType="domain.Board"  resultType="domain.Board">
        SELECT starting_point, destination, created_date, update_date, title, content, user.nickname
        FROM board
        LEFT JOIN user ON board.writer_id=user.id
        WHERE starting_point=#{startingPoint} AND destination=#{destination}
    </select>


    <update id="updateBoard" parameterType="domain.Board" >
        UPDATE user(starting_point, destination, title, content, update_date)
        VALUES(#{startingPoint}, #{destination}, #{title}, #{content}, DEFAULT)
        WHERE board_id=#{boardId}
    </update>

    <delete id="deleteBoard" parameterType="Long">
        DELETE board where board_id=#{boardId}
    </delete>
</mapper>