<!DOCTYPE html>
<html>
<head>
    <meta charset="EUC-KR">
    <title>RESTful 웹서비스 클라이언트(JSON)</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" >
        $(function(){
            userLogin();

            userRegister();


            boardSelect();

            boardInsert();
        });

        //사용자 등록 요청
        function boardInsert(){
            //등록 버튼 클릭
            $('#btnInsert').on('click',function(){
                var title = $('input:text[name="title"]').val();
                var content = $('input:radio[name="content"]:checked').val();
                var destination = $('select[name="destination"]').val();
                $.ajax({
                    url: "board/",
                    type: 'POST',
                    dataType: 'json',
                    data: JSON.stringify({ title:title,content: content, destination : destination }),
                    contentType: 'application/json',
                    mimeType: 'application/json',
                    Authorization: '',
                    success: function(response) {
                        if(response.result == true) {

                        }
                    },
                    error:function(xhr, status, message) {
                        alert(" status: "+status+" er:"+message);
                    }
                });
            });//등록 버튼 클릭
        }//userInsert

        //게시물 조회 요청
        function boardSelect(){
            //조회 버튼 클릭
            $('body').on('click', '#btnSelect', function(){
                var boardId = $(this).closet('tr').find('#hidden_id').val();
                //특정 게시물 조회
                $.ajax({
                    url:'board/' + boardId,
                    type:'GET',
                    contentType:'application/json;charset=utf-8',
                    dataType:'json',
                    error:function(xhr, status, msg){
                        alert("상태값 : " + status + "Http 에러 메시지" + msg)
                    },
                    success:boardSelectResult
                });
            });
        }

        //게시물 조회 응답
        function boardSelectResult(xhr){
            var board = xhr.data;
            $('input:text[name="title"]').val(board.title);
            $('input:text[name="content"]').val(board.content);
            $('input:text[name="destination"]').val(board.destination);
        }//boardSelectResult

        //사용자 목록 조회 요청
        function boardList() {
            $.ajax({
                url:'board/',
                type:'GET',
                contentType:'application/json;charset=utf-8',
                dataType:'json',
                error:function(xhr,status,msg){
                    alert("상태값 :" + status + " Http에러메시지 :"+msg);
                },
                success:boardListResult
            });
        }//userList

        //사용자 목록 조회 응답
        function boardListResult(xhr) {
            console.log(xhr.data);
            $("tbody").empty();
            $.each(xhr.data,function(idx,item){
                $('<tr>')
                    .append($('<td>').html(item.title))
                    .append($('<td>').html(item.nickname))
                    .append($('<td>').html(item.destination))
                    .append($('<td>').html('<button id=\'btnSelect\'>조회</button>'))
                    .append($('<input type=\'hidden\' id=\'hidden_id\'>').val(item.board_Id))
                    .appendTo('tbody');
            });//each
        }//userListResult
    </script>
</head>
<body>
<div class="container">
    <form id="form1"  class="form-horizontal">
        <h2>사용자 등록 및 수정</h2>
        <div class="form-group">
            <label>제목:</label>
            <input type="text"  class="form-control"  name="title" >
        </div>
        <div class="form-group">
            <label>내용:</label>
            <input type="text"  class="form-control"  name="content" >
        </div>
        <div class="form-group">
            <label>목적지:</label>
            <input type="text"  class="form-control"  name="destination" >
        </div>
        <div class="btn-group">
            <input type="button"  class="btn btn-primary" value="등록"  id="btnInsert" />
            <input type="button"  class="btn btn-primary" value="수정"  id="btnUpdate" />
            <input type="button"  class="btn btn-primary" value="초기화" id="btnInit" />
        </div>
    </form>
</div>
<hr/>
<div class="container">
    <h2>게시글 목록</h2>
    <table class="table text-center">
        <thead>
        <tr>
            <th class="text-center">제목</th>
            <th class="text-center">내용</th>
            <th class="text-center">목적지</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
</body>
</html>